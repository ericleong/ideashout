{% extends 'base.html' %}
{% load humanize %}

{% block title %}Events{% endblock %}

{% block content %}

<div class="post-types">
	<span><a class="stationary" href="{% url ideas %}">Ideas</a></span>
	<span><a class="stationary" href="{% url links %}">Links</a></span>
	<span><a class="stationary" href="{% url events %}">Events</a></span>
</div>

{% for post in posts %}
{% if user.is_authenticated or not post.private %}
{% ifchanged post.start_time.date %} 
	<h2 class="event-day">{{ post.start_time.date }}</h2>
	<ul class="posts"> 
{% endifchanged %}
	<li class="post">
		<div class="post-title">
			<a href="{% if post.link %}{{ post.link }}{% else %}{{ post.get_absolute_url }}{% endif %}">{{ post.title }}</a>
		</div>
		<div class="post-details">
			<span class="post-author">posted by <a href="{% url userprofile post.author %}">{{ post.author }}</a></span>
			<span class="post-created">{{ post.created|naturaltime }}</span>
			with <span class="post-comments"><a href="{{ post.get_absolute_url }}">{{ post.responses.count }} response{{ post.responses.count|pluralize }}</a></span>
			and <span class="post-commits"><a href="{{ post.get_absolute_url }}">{{ post.committed.count }} commitment{{ post.committed.count|pluralize }}</a></span>
		</div>
		<div class="post-info">
			{% if post.location %}
			<div class="post-location">
				<a href="http://maps.google.com/maps?q={{ post.location.address|urlencode }}">
					<div class="post-location-name">{{ post.location.name|escapejs }}
					{% if post.location.room %}<span class="post-location-room">({{ post.location.room|escapejs }})</span>{% endif %}
					</div>
					<div class="post-location-address">{{ post.location.address|escapejs }}</div>
				</a> 
			</div>
			{% endif %}
			{% if post.start_time %}
			<div class="post-time">
				<span class="post-start-time">{{ post.start_time|date:"f A l F j" }}</span>
				 to 
				<span class="post-end-time">{{ post.end_time|date:"f A l F j" }}</span>
			</div>
			{% endif %}
		</div>
	</li>
	{% ifchanged post.start_time.date %} </ul> {% endifchanged %}
{% endif %}
{% endfor %}

{% endblock %}